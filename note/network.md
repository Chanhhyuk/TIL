# Network

## HTTP(HyperText Tranfer Protocol)
- 초기에는 하이퍼 문서를 전송하는데 쓰임
- 현재는 이미지, 영상, 음성, 파일, JSON 등 모든 형태의 데이터 전송가능
- 인터넷의 모든 것은 HTTP로 이루어져 있다

인터넷주소 요청메시지
- 쿼리 파라미터를 통한 데이터 전송
get 메소드
?로 시작, &로 추가 가능
key=value의 형태

- 메세지 바디를 통한 데이터 전송
POST, PUT, PATCH 메소드

* HTTP 요청 메세지
첫줄은 요청하는 방식     // 메소드 + 요청대상(경로) + HTTP버전
header (헤더 필드)    // 모든 부가 정보 (HTTP 전송에 필요한 메타데이터)
공백라인    
message body (메세지 본문)   // 실제 전송할 데이터(JSON / HTML문서 / 이미지 / 영상 등)

* HTTP 응답 메세지
첫줄은 요청하는 방식     // HTTP버전 + 상태코드 + 문구
header (헤더 필드)    // 모든 부가 정보 (HTTP 전송에 필요한 메타데이터)
공백라인    
message body (메세지 본문)   // 실제 전송할 데이터(JSON / HTML문서 / 이미지 / 영상 등)



### Network communication (네트워크 통신)
네트워크 통신은 Network server와 DB server를 갖추고 안정적으로 운영하기 위해 IDC에 관리를 위탁해야하며 불법적인 접근과 해킹을 막기 위해 firewall(방화벽)을 설치해야 하고 대량의 요청을 처리하기 위해 SLB(부하분산장치)도 추가 해야한다.

종류

Socket(소켓) 방식의 연결 지향 통신
Socket(소켓)을 이용한 네트워크 방식 보통 Low-level(저수준)통신을 통하여 구현된다. 앱과 서버가 연결되면 한쪽에서 명시적으로 끊을 때까지 지속해서 연결을 유지하는 방식.
연결이 계속 유지하므로 재연결할 필요 없이 원하는 만큼 빠르게 메시지를 주고 받는다는 장점이 있지만 네트워크 대역의 많은 소모와 서버 부하가 크다는 단점이 있다.

TCP는 완전한 전송을 보장하지만 상대적으로 덜 빠르다.
UDP는 완전한 전송을 보장하지 않지만 더 빠르다. 

비연결 지향 통신
대표적으로 HTTP/HTTPS 프로토콜이 있으며 웹 서비스에 주로 사용된다.
요청이 들어오면 이에 맞는 응답을 보낸 후 바로 연결을 종료한다. 
단지 연결을 유지하지 않는 것일 뿐.

### HTTP 메시지
주소줄에 도메인을 입력하거나 특정 링크를 클릭하여 원하는 페이지로 이동할 때 일정한 형식을 갖춘 텍스트 기반 메시지로 변환되어 웹 서버로 전달되는데 이 메시지 형식을 HTTP 메시지 라고 한다.

### HTTPS
HTTP 경우 모두 평문 그대로 전송하기 때문에, 누군가 패킷을 훔쳐보는Sniffing(스니핑) 공격에 취약하다. 금융이나 개인정보 메시지처럼 보호될 필요가 있을 때에는 인증서를 통해 패킷을 암호화한 다음에 전송하게 되는데 이것을 HTTP + S(Seciroty)인 HTTPS라고 부른다. HTTPS 통신은 단순히 HTTP통신 프로토콜에 S를 붙여준다고 지원되는게 아니다 보안 통신을 위해서는 신뢰성있는 인증기관에서 발급한 인증서를 서버에 설치해 주어야 한다.

### HTTP 메시지의 구조
HTTP 메시지는 크게 Request(요청)메시지와 Response(응답) 메시지로 나눌 수 있다. 둘다 라인-헤더-바디 세 부분으로 구성된다.
라인은 응답/요청 여부, 메시지 전송 방식 상태 정보 등이 작성됨.
헤더는 메시지 본문에 대한 메타 정보가 들어가는 곳.
바디는 실제로 보내고자 하는 메시지 본문 내용이 들어감.
HTTP는 매우 정형화되어 있어서, 라인은 무조건 한 줄로만 작성된다. 그 아래에는 필요한 만큼 여러 줄로 작성된 헤더가 들어간다.
헤더와 바디는 유동적이므로, 구분을 위해 한 줄의 공백이 삽입된다.
즉 첫번재는 무조건 라인영역이고 다음 내용들은 공백 한줄이 나타날때까지 헤더로 간주한다.
```
POST /userAccount/login HTTP/1.1
Host: swiftapi.naver.com:2029 
Content-Type: application/x-www-form-urlencoded

account=swift%40swift.com&passwd=1234&grant_type=password
```
header는 key : value로 이뤄진다.
두 개이상의 도메인이 연결되어있을 경우 구분하기 위해 포트번호 사용
POST 방식이다. 회원가입 로그인 게시판 글쓰기 등 많은 UI들이 대부분 이 방식을 사용해서 서버로 값을 전송한다.
API 연동을 위해 사용할 메시지 형식이 JSON이라면(대부분이 JSON이다) Content-Type 헤더의 값을 application/json으로 설정해 주어야 한다. 그렇지 않으면 서버에서 메시지 본문을 제대로 해석하지 못할 수 있다.

공백라인 아래는 본문내용이다. 헤더의 Content-Type에 설정된 타입과 일치해야 한다. 예를 들어 account, passwd, grant_type의 세개이므로 이를 x-www-form-urlencoded 타입으로 이들 데이터를 &로 연결하여 메시지 본문을 넣어야 한다. 여기서 특수문자의 경우 URLEncoding 형식으로 변환한다.

```
GET /userAccount/login?account=swift@naver.com&amp;passwd=1234&amp;grand_type=password HTTP/1.1
Host: api.naver.com:2029
Cache-Control: no-cache
```

메시지 본문이 사라지고, 본문에 있어야할 값이 첫 번째 라인의 경로 뒤에 ? 문자열과 함께 연결되었다.
GET 방식에서는 파라미터를 모두 URL 뒤에 연결해서 전달하기 때문이다. 이렇게 연결된 파라미터를 Query String(쿼리 스트링) 이라고 한다.
GET방식은 메시지 본문을 사용하지 않기 때문에 Content-Type 헤더가 사용되지 않는다. 또한 URL 뒤에 쿼리 스트링만 연결하면 되므로 비교적 간결하세 정보를 전달 할 수 있다는 장점이 있다. 하지만 URL경로는 1024Byte 까지만 허용되기 때문에, 긴 값을 GET방식으로 전송할 수 없다. 그래서 데이터를 전송하기 보단 요청할 때 주로 사용된다.

메소드(전송 방식)|목적|
---|---
GET|특정 리소스의 대표적인 정보를 요청할 때
POST|ID 없이 리소스를 생성하거나 수정할 때
PUT|ID 기반으로 리소스를 생성하거나 수정할 때
DELETE|리소스를 삭제할 때
HEAD|GET 방식의 요청이지만 내용 없이 메타정보만 요청할 때
OPTIONS|특정 URL에 대한 보조 메소드 역할

## RESTful API (Representational State Transfer) 
HTTP를 위한 아키텍처의 한 형식. 네트워크 프로토콜이라기 보다는 네트워크 자원을 정의하고 자원에 대한 주소를 관리하는 방법.
HTTP 기반으로 간단히 주고 받기 위해 정의된 간단한 형식의 인터페이스.
기존 HTTP 프로토콜을 사용하기 편하다
REST 구조를 따라 구현된 시스템을 RESTful 이라고 한다.
RESTful 기반으로 서버에서 요청과 응답을 주고 받을 수 있도록 정의된 형식을 RESTful API라고 한다.
특히 RESTful API는 메시지 본문을 JSON형식으로 보내기 때문에 RESTful API 통신을 위해서는 JSON 데이터 형식을 잘 이해하고 있어야 한다.



